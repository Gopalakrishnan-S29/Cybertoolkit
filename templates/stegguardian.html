{% extends "base.html" %}
{% block content %}

<!-- ================= STEGGUARDIAN HEADER ================= -->
<div class="pg-header-row">

    <div class="pg-header-left">
        <a href="{{ url_for('system_security') }}" class="pg-back-btn">‚Üê Back</a>

        <div>
            <h1 class="page-title">StegGuardian</h1>
            <p class="page-desc">
                Detect hidden data inside images using statistical steganalysis
            </p>
        </div>
    </div>

</div>

<div class="divider"></div>

<!-- ================= UPLOAD PANEL ================= -->
<form method="POST" enctype="multipart/form-data" class="sg-upload-box">

    <input type="file"
           name="image"
           accept=".png,.jpg,.jpeg"
           class="sg-file-input"
           required>

    <button type="submit" class="sg-btn primary">
        Analyze Image
    </button>

</form>

{% if image_name %}
<div class="sg-preview">
    <div class="sg-preview-info">
        <strong>Uploaded Image:</strong> {{ image_name }}
    </div>

    <img src="{{ url_for('uploaded_file', filename=image_name) }}"
         alt="Uploaded Image"
         class="sg-image">
</div>
{% endif %}

{% if result %}
<div class="divider"></div>

<h3 class="sg-subtitle">Analysis Report</h3>

<table class="pg-table">
    <thead>
        <tr>
            <th>Metric</th>
            <th>Value</th>
        </tr>
    </thead>
    <tbody>
        <tr><td>Resolution</td><td>{{ result.resolution }}</td></tr>
        <tr><td>File Size (KB)</td><td>{{ result.file_size_kb }}</td></tr>
        <tr><td>Entropy</td><td>{{ result.entropy }}</td></tr>
        <tr><td>LSB Anomaly Score</td><td>{{ result.lsb_score }}</td></tr>
        <tr><td>Size Anomaly</td><td>{{ result.size_anomaly }}</td></tr>

        <tr class="
            {% if result.risk == 'High' %}risk
            {% elif result.risk == 'Medium' %}warn
            {% else %}safe{% endif %}
        ">
            <td><strong>Risk Level</strong></td>
            <td>
                {% if result.risk == "Low" %}
                    <span class="risk safe">Low</span>
                {% elif result.risk == "Medium" %}
                    <span class="risk warn">Medium</span>
                {% else %}
                    <span class="risk high">High</span>
                {% endif %}
            </td>
        </tr>
    </tbody>
</table>
{% endif %}

{% endblock %}
