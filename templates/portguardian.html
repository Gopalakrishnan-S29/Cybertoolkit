{% extends "base.html" %}
{% block content %}

<!-- ================= PORTGUARDIAN SOC HEADER ================= -->
<section class="pg-soc">

    <!-- TOP BAR -->
    <div class="pg-topbar">
        <div class="pg-brand">
            <span class="pg-icon">üõ°Ô∏è</span>
            <span class="pg-title">PortGuardian++</span>
        </div>

        <form action="{{ url_for('send_port_report') }}" method="POST">
            <button class="pg-report-btn">Generate Report</button>
        </form>
    </div>

    <!-- METRICS STRIP -->
    <div class="pg-metrics-strip">

        <div class="pg-metric">
            <span class="pg-label">Total Open Connections</span>
            <span class="pg-value blue">{{ ports | length }}</span>
        </div>

        <div class="pg-divider"></div>

        <div class="pg-metric">
            <span class="pg-label">Risky Ports</span>
            <span class="pg-value red">
                {{ ports | selectattr("port", "in", risky_ports) | list | length }}
            </span>
        </div>

        <!-- GLOBE IMAGE -->
        <div class="pg-globe">
            <img src="{{ url_for('static', filename='images/tools/portguardian_visual.png') }}">
        </div>

    </div>

    <!-- SCAN LINE -->
    <div class="pg-scanline"></div>

</section>

<!-- ================= RESULTS TABLE ================= -->
<section class="pg-table-wrap">

    <table class="pg-table">
        <thead>
            <tr>
                <th>Port</th>
                <th>Service</th>
                <th>Process</th>
                <th>Status</th>
                <th>Risk</th>
            </tr>
        </thead>
        <tbody>
            {% for entry in ports %}
            <tr class="{% if entry.port in risky_ports %}risk{% endif %}">
                <td>{{ entry.port }}</td>
                <td>{{ entry.service }}</td>
                <td>{{ entry.process }}</td>
                <td>Listening</td>
                <td>
                    {% if entry.port in risky_ports %}
                        <span class="risk-badge high">High</span>
                    {% else %}
                        <span class="risk-badge safe">Safe</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

</section>

{% endblock %}
