{% extends "base.html" %}
{% block content %}

<!-- ================= CONFIGGUARD HEADER ================= -->
<div class="pg-header-row">

    <div class="pg-header-left">
        <a href="{{ url_for('system_security') }}" class="pg-back-btn">← Back</a>

        <div>
            <h1 class="page-title">ConfigGuard</h1>
            <p class="page-desc">
                Secure configuration assessment and system hardening analysis
            </p>
        </div>
    </div>

</div>

<div class="divider"></div>

<!-- ================= CONFIG TABLE ================= -->
<section class="cg-table-wrap">

    <table class="pg-table">
        <thead>
            <tr>
                <th>Configuration Check</th>
                <th>Status</th>
                <th>Risk</th>
                <th>Recommendation</th>
                <th>Action</th>
            </tr>
        </thead>

        <tbody>
            {% for item in results %}
            <tr class="
                {% if item.risk == 'High' %}risk
                {% elif item.risk == 'Medium' %}warn
                {% else %}safe{% endif %}
            ">
                <td>{{ item.check }}</td>
                <td>{{ item.status }}</td>
                <td>
                    {% if item.risk == 'Low' %}
                        <span class="risk safe">Low</span>
                    {% elif item.risk == 'Medium' %}
                        <span class="risk warn">Medium</span>
                    {% else %}
                        <span class="risk high">High</span>
                    {% endif %}
                </td>
                <td>{{ item.recommendation }}</td>
                <td>
                    {% if item.slug is defined %}
                        <a href="{{ url_for('fix_guide', check_name=item.slug) }}"
                           target="_blank"
                           class="cg-fix-btn">
                            How to Fix
                        </a>
                    {% else %}
                        —
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

</section>

<div class="cg-footer">
    ConfigGuard provides <strong>advisory guidance only</strong>.
    No system settings are modified automatically.
</div>

{% endblock %}
