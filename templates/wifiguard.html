{% extends "base.html" %}
{% block content %}

<!-- ================= WIFIGUARD HEADER ================= -->
<div class="pg-header-row">

    <div class="pg-header-left">
        <a href="{{ url_for('system_security') }}" class="pg-back-btn">← Back</a>

        <div>
            <h1 class="page-title">WiFiGuard</h1>
            <p class="page-desc">
                Passive wireless network discovery and security risk assessment
            </p>
        </div>
    </div>

    <div>
        <a href="{{ url_for('wifiguard_v2') }}" class="wg-advanced-link">
            Advanced Analysis
        </a>
    </div>

</div>

<div class="divider"></div>

<!-- ================= ACTION ================= -->
<form method="POST" class="wg-actions">
    <button type="submit" class="wg-btn primary">
        Scan Wi-Fi Networks
    </button>
</form>

{% if error %}
<div class="wg-error">{{ error }}</div>
{% endif %}

<!-- ================= NETWORK RESULTS ================= -->
{% if networks %}
<section class="wg-table-wrap">

    <table class="pg-table">
        <thead>
            <tr>
                <th>SSID</th>
                <th>Security</th>
                <th>Signal</th>
                <th>Channel</th>
                <th>Risk</th>
            </tr>
        </thead>

        <tbody>
            {% for net in networks %}
            <tr class="{% if net.risk in ['High','Critical'] %}risk{% endif %}">
                <td>{{ net.ssid or "Hidden" }}</td>
                <td>{{ net.security }}</td>
                <td>{{ net.signal if net.signal is defined else "—" }}</td>
                <td>{{ net.channel if net.channel is defined else "—" }}</td>
                <td>
                    {% if net.risk in ['High','Critical'] %}
                        <span class="risk high">{{ net.risk }}</span>
                    {% elif net.risk == 'Medium' %}
                        <span class="risk warn">Medium</span>
                    {% else %}
                        <span class="risk safe">Low</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

</section>
{% endif %}

<!-- ================= CHANNEL CONGESTION ================= -->
{% if channel_congestion %}
<section class="wg-table-wrap">

    <h3 class="wg-subtitle">Channel Congestion Analysis</h3>

    <table class="pg-table">
        <thead>
            <tr>
                <th>Channel</th>
                <th>Networks Detected</th>
                <th>Status</th>
            </tr>
        </thead>

        <tbody>
            {% for ch in channel_congestion %}
            <tr class="risk">
                <td>{{ ch.channel }}</td>
                <td>{{ ch.networks }}</td>
                <td><span class="risk high">Congested</span></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

</section>
{% endif %}

<div class="wg-footer">
    WiFiGuard performs <strong>passive scanning only</strong>.
    No traffic interception or active attacks are performed.
</div>

{% endblock %}
