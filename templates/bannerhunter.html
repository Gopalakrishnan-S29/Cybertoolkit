{% extends "base.html" %}
{% block content %}

<!-- ================= BANNERHUNTER HEADER ================= -->
<div class="pg-header-row">

    <div class="pg-header-left">
        <a href="{{ url_for('reconnaissance') }}" class="pg-back-btn">← Back</a>

        <div>
            <h1 class="page-title">BannerHunter</h1>
            <p class="page-desc">
                Service banner grabbing and passive product fingerprinting
            </p>
        </div>
    </div>

</div>

<div class="divider"></div>

<!-- ================= SCAN FORM ================= -->
<form action="{{ url_for('bannerhunter') }}"
      method="POST"
      autocomplete="off"
      class="bh-form">

    <input
        type="text"
        name="target"
        class="bh-input"
        placeholder="Hostname or IP (e.g. scanme.nmap.org)"
        required
        value="{{ target or '' }}"
    >

    <input
        type="text"
        name="ports"
        class="bh-input ports"
        placeholder="Ports (e.g. 22,80,443)"
        value="{{ ports or '' }}"
    >

    <button type="submit" class="bh-btn primary">
        Scan
    </button>

</form>

{% if target %}
<div class="divider"></div>

<section class="bh-results">

    <h3 class="bh-subtitle">
        Results for <span class="bh-target">{{ target }}</span>
    </h3>

    <div class="bh-meta">
        Scanned at: {{ result.scanned_at if result else '—' }}
    </div>

    {% if result.note %}
        <div class="bh-note">{{ result.note }}</div>
    {% endif %}

    {% if result.entries %}
    <table class="pg-table">
        <thead>
            <tr>
                <th>IP</th>
                <th>Port</th>
                <th>Product</th>
                <th>Version</th>
                <th>Risk</th>
                <th>Banner / Raw</th>
            </tr>
        </thead>
        <tbody>
        {% for e in result.entries %}
            <tr class="
                {% if e.risk == 'potentially_outdated' %}warn
                {% elif e.risk == 'ok' %}safe
                {% else %}{% endif %}
            ">
                <td>{{ e.ip }}</td>
                <td>{{ e.port }}</td>
                <td>{{ e.product or '-' }}</td>
                <td>{{ e.version or '-' }}</td>
                <td>
                    {% if e.risk == 'ok' %}
                        <span class="risk safe">OK</span>
                    {% elif e.risk == 'potentially_outdated' %}
                        <span class="risk warn">Potentially Outdated</span>
                    {% else %}
                        <span class="risk">Unknown</span>
                    {% endif %}
                </td>
                <td>
                    <pre class="bh-pre">
{{ e.raw or e.error or '(no banner)' }}
                    </pre>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
        <div class="bh-note">No entries collected.</div>
    {% endif %}

</section>
{% endif %}

{% endblock %}
