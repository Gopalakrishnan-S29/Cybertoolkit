{% extends "base.html" %}
{% block content %}

<!-- ================= WIFIGUARD ADVANCED HEADER ================= -->
<div class="pg-header-row">

    <div class="pg-header-left">
        <a href="{{ url_for('wifiguard') }}" class="pg-back-btn">← Back</a>

        <div>
            <h1 class="page-title">WiFiGuard Advanced</h1>
            <p class="page-desc">
                Passive wireless security intelligence & environmental risk assessment
            </p>
        </div>
    </div>

</div>

<div class="divider"></div>


{% if error %}
<div class="wg-error">{{ error }}</div>
{% endif %}

{% if summary %}
<!-- ================= SUMMARY METRICS ================= -->
<div class="wg-adv-metrics">

    <div class="wg-metric-box">
        <span class="label">Total Networks</span>
        <span class="value">{{ summary.total_networks }}</span>
    </div>

    <div class="wg-metric-box danger">
        <span class="label">High Risk</span>
        <span class="value">{{ summary.high_risk }}</span>
    </div>

    <div class="wg-metric-box warn">
        <span class="label">Open Networks</span>
        <span class="value">{{ summary.open_networks }}</span>
    </div>

    <div class="wg-metric-box info">
        <span class="label">Interference Zones</span>
        <span class="value">{{ summary.congested_channels }}</span>
    </div>

</div>

<div class="divider"></div>

<!-- ================= ENCRYPTION DISTRIBUTION ================= -->
<section class="wg-adv-section">
    <h3 class="wg-subtitle">Encryption Distribution</h3>

    <table class="pg-table">
        <thead>
            <tr>
                <th>Encryption</th>
                <th>Networks</th>
            </tr>
        </thead>
        <tbody>
            {% for sec, count in encryption.items() %}
            <tr>
                <td>{{ sec }}</td>
                <td>{{ count }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</section>

<!-- ================= CHANNEL OVERLAP ================= -->
{% if overlap %}
<section class="wg-adv-section">
    <h3 class="wg-subtitle">Channel Overlap & Interference (2.4 GHz)</h3>

    <table class="pg-table">
        <thead>
            <tr>
                <th>Primary Channel</th>
                <th>Affected Channels</th>
                <th>Networks</th>
                <th>Risk</th>
            </tr>
        </thead>
        <tbody>
            {% for o in overlap %}
            <tr class="risk">
                <td>{{ o.primary_channel }}</td>
                <td>{{ o.affected_channels | join(', ') }}</td>
                <td>{{ o.networks }}</td>
                <td><span class="risk high">{{ o.risk }}</span></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</section>
{% endif %}

<!-- ================= RISK REASONING ================= -->
<section class="wg-adv-section">
    <h3 class="wg-subtitle">SSID Risk Reasoning</h3>

    <table class="pg-table">
        <thead>
            <tr>
                <th>SSID</th>
                <th>Security</th>
                <th>Signal</th>
                <th>Channel</th>
                <th>Risk Score</th>
                <th>Observations</th>
                <th>Risk</th>
            </tr>
        </thead>
        <tbody>
            {% for net in analysis %}
            <tr class="{% if net.risk in ['High','Critical'] %}risk{% endif %}">
                <td>{{ net.ssid }}</td>
                <td>{{ net.security }}</td>
                <td>{{ net.signal }}</td>
                <td>{{ net.channel }}</td>
                <td><strong>{{ net.risk_score }}</strong></td>
                <td>{{ net.observations }}</td>
                <td>
                    {% if net.risk in ['High','Critical'] %}
                        <span class="risk high">{{ net.risk }}</span>
                    {% else %}
                        <span class="risk safe">{{ net.risk }}</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</section>

<div class="wg-footer">
    WiFiGuard Advanced performs <strong>passive analysis only</strong>.  
    Channel overlap is calculated using the <strong>1–6–11 interference model</strong>.
</div>

{% endif %}

{% endblock %}
