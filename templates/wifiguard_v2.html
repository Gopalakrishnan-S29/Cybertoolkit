<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WiFiGuard v2 ‚Äì Advanced Analysis</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
/* ================= GLOBAL ================= */
body {
    margin: 0;
    font-family: 'Inter', sans-serif;
    background: #f4f6fb;
    color: #1f2937;
}

/* ================= HEADER ================= */
.header {
    background: linear-gradient(90deg, #0f2027, #203a43, #2c5364);
    color: #ffffff;
    padding: 18px 28px;
    text-align: center;
}

.header h1 {
    margin: 0;
    font-size: 26px;
}

.header p {
    margin-top: 6px;
    font-size: 14px;
    color: #d1d5db;
}

/* ================= CONTAINER ================= */
.container {
    max-width: 1100px;
    margin: 30px auto;
    padding: 0 20px;
}

/* ================= TOOL HEADER ================= */
.tool-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
}

.tool-subtitle {
    font-size: 14px;
    color: #6b7280;
}

/* ================= BUTTON ================= */
.btn-primary {
    background: #2563eb;
    color: #ffffff;
    border: none;
    padding: 10px 18px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
}

.btn-primary:hover {
    background: #1d4ed8;
}

/* ================= ALERT ================= */
.alert {
    padding: 12px;
    border-radius: 8px;
    margin-bottom: 20px;
}

.alert.error {
    background: #fee2e2;
    color: #991b1b;
}

/* ================= SUMMARY CARDS ================= */
.card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 18px;
    margin-bottom: 30px;
}

.card {
    background: #ffffff;
    padding: 18px;
    border-radius: 14px;
    text-align: center;
    box-shadow: 0 6px 14px rgba(0,0,0,0.08);
    font-weight: 600;
}

.card strong {
    display: block;
    font-size: 28px;
    margin-top: 6px;
}

.card.danger { border-left: 4px solid #dc2626; }
.card.warning { border-left: 4px solid #f59e0b; }
.card.info { border-left: 4px solid #2563eb; }

/* ================= TABLES ================= */
.table-card {
    background: #ffffff;
    border-radius: 14px;
    padding: 20px;
    box-shadow: 0 6px 14px rgba(0,0,0,0.08);
    margin-bottom: 30px;
}

.table-card h3 {
    margin-top: 0;
    margin-bottom: 14px;
}

table {
    width: 100%;
    border-collapse: collapse;
}

th {
    background: #1f2937;
    color: #ffffff;
    padding: 12px;
    font-size: 14px;
    text-align: left;
}

td {
    padding: 12px;
    border-bottom: 1px solid #e5e7eb;
    font-size: 14px;
}

tr:hover {
    background: #f9fafb;
}

/* ================= RISK TABLE ================= */
.security-table th {
    background: #020617;
}

.row-danger {
    background: #fee2e2;
}

/* ================= FOOTER ================= */
.tool-footer {
    font-size: 14px;
    color: #6b7280;
    margin-top: 25px;
    text-align: center;
}

.back-btn {
    display: inline-block;
    margin-top: 16px;
    text-decoration: none;
    font-weight: 600;
    color: #2563eb;
}
</style>
</head>

<body>

<div class="header">
    <h1>üì° WiFiGuard v2 ‚Äì Advanced Analysis</h1>
    <p>Passive wireless security intelligence & environmental risk assessment</p>
</div>

<div class="container">

    <div class="tool-header">
        <div>
            <h2>Advanced Wireless Analysis</h2>
            <p class="tool-subtitle">
                Professional-grade passive WiFi risk reasoning (1‚Äì6‚Äì11 model)
            </p>
        </div>

        <form method="POST">
            <button type="submit" class="btn-primary">üîç Run Advanced Analysis</button>
        </form>
    </div>

    {% if error %}
        <div class="alert error">{{ error }}</div>
    {% endif %}

    {% if summary %}
    <!-- SUMMARY -->
    <div class="card-grid">
        <div class="card">Total Networks<strong>{{ summary.total_networks }}</strong></div>
        <div class="card danger">High Risk<strong>{{ summary.high_risk }}</strong></div>
        <div class="card warning">Open Networks<strong>{{ summary.open_networks }}</strong></div>
        <div class="card info">Interference Zones<strong>{{ summary.congested_channels }}</strong></div>
    </div>

    <!-- ENCRYPTION -->
    <div class="table-card">
        <h3>üîê Encryption Distribution</h3>
        <table>
            <tr><th>Encryption</th><th>Networks</th></tr>
            {% for sec, count in encryption.items() %}
            <tr><td>{{ sec }}</td><td>{{ count }}</td></tr>
            {% endfor %}
        </table>
    </div>

    <!-- CHANNEL OVERLAP -->
    {% if overlap %}
    <div class="table-card">
        <h3>üì° Channel Overlap & Interference (2.4 GHz)</h3>
        <table>
            <tr>
                <th>Primary Channel</th>
                <th>Affected Channels</th>
                <th>Networks</th>
                <th>Risk</th>
            </tr>
            {% for o in overlap %}
            <tr>
                <td>{{ o.primary_channel }}</td>
                <td>{{ o.affected_channels | join(', ') }}</td>
                <td>{{ o.networks }}</td>
                <td>{{ o.risk }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    {% endif %}

    <!-- RISK REASONING -->
    <div class="table-card">
        <h3>üß† SSID Risk Reasoning</h3>
        <table class="security-table">
            <tr>
                <th>SSID</th>
                <th>Security</th>
                <th>Signal</th>
                <th>Channel</th>
                <th>Risk Score</th>
                <th>Observations</th>
                <th>Risk</th>
            </tr>
            {% for net in analysis %}
            <tr class="{% if net.risk in ['High','Critical'] %}row-danger{% endif %}">
                <td>{{ net.ssid }}</td>
                <td>{{ net.security }}</td>
                <td>{{ net.signal }}</td>
                <td>{{ net.channel }}</td>
                <td><strong>{{ net.risk_score }}</strong></td>
                <td>{{ net.observations }}</td>
                <td>{{ net.risk }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    {% endif %}

    <div class="tool-footer">
        ‚ÑπÔ∏è WiFiGuard v2 performs <strong>passive analysis only</strong>.  
        Channel overlap is calculated using industry-standard 1‚Äì6‚Äì11 interference modeling.
    </div>

    <a href="{{ url_for('wifiguard') }}" class="back-btn">‚¨Ö Back to Quick Scan</a>

</div>

</body>
</html>
